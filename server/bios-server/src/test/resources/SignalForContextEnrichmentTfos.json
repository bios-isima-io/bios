{
  "name": "patientVisits",
  "type": "signal",
  "missingValuePolicy": "strict",
  "attributes": [
    {"name": "visitId",       "type": "long"},
    {"name": "patientId",     "type": "long"},
    {"name": "resourceId",    "type": "string"}
  ],
  "preprocesses": [
    {
      "name": "resourceDetails",
      "condition": "resourceId",
      "missingLookupPolicy": "strict",
      "actions": [
        {
          "actionType": "merge",
          "context": "enrichedContext",
          "attribute": "resourceTypeNum"
        },
        {
          "actionType": "merge",
          "context": "enrichedContext",
          "attribute": "zipcode"
        },
        {
          "actionType": "merge",
          "context": "enrichedContext",
          "attribute": "resourceTypeCode"
        },
        {
          "actionType": "merge",
          "context": "enrichedContext",
          "attribute": "myResourceCategory"
        },
        {
          "actionType": "merge",
          "context": "enrichedContext",
          "attribute": "cost"
        },
        {
          "actionType": "merge",
          "context": "enrichedContext",
          "attribute": "resourceValue"
        }
      ]
    }
  ]
}