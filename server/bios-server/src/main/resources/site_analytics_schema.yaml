signals:
  - signalName: pageViews
    missingAttributePolicy: Reject
    attributes:
      - attributeName: sessionId
        type: String
        description: Generated by Wordpress
      - attributeName: siteUrl
        type: String
      - attributeName: host
        type: String
      - attributeName: userAgent
        type: String
      - attributeName: requestMethod
        type: String
      - attributeName: queryString
        type: String
      - attributeName: pageUri
        type: String
      - attributeName: cookie
        type: String
      - attributeName: userId
        type: String
        description: Wordpress user ID
      - attributeName: ipAddress
        type: String
        description: Client's IP address
      - attributeName: redirectUrl
        type: String
      - attributeName: referrer
        type: String
      - attributeName: contentType
        type: String
      - attributeName: action
        type: String
        missingAttributePolicy: StoreDefaultValue
        default: MISSING
        description: From query parameter
      - attributeName: page
        type: String
        missingAttributePolicy: StoreDefaultValue
        default: MISSING
        description: From query parameter
      - attributeName: context
        type: String
        missingAttributePolicy: StoreDefaultValue
        default: MISSING
        description: From query parameter
      - attributeName: utmSource
        type: String
        missingAttributePolicy: StoreDefaultValue
        default: MISSING
        description: From query parameter. Label from ad platform (google, facebook)
      - attributeName: utmMedium
        type: String
        missingAttributePolicy: StoreDefaultValue
        default: MISSING
        description: From query parameter. Ad or marketing medium where the ad was placed (search, email, video, newsletter)
      - attributeName: utmCampaign
        type: String
        missingAttributePolicy: StoreDefaultValue
        default: MISSING
        description: From query parameter. Label of tthe individual campaign (black friday sale)
      - attributeName: utmTerm
        type: String
        missingAttributePolicy: StoreDefaultValue
        default: MISSING
        description: From query parameter. Label of ad groups, keywords or ad sets (CFRetarget - click funnel retarget)
      - attributeName: utmContent
        type: String
        missingAttributePolicy: StoreDefaultValue
        default: MISSING
        description: From query parameter. Other more descriptive names etc. (pink marble hue)
      - attributeName: timeOrigin
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
        tags:
          category: Quantity
          kind: Timestamp
          unit: UnixMillisecond
          firstSummary: WORD_CLOUD
      - attributeName: navigationStart
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
        tags:
          category: Quantity
          kind: Timestamp
          unit: UnixMillisecond
          firstSummary: WORD_CLOUD
      - attributeName: domainLookupStart
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
        tags:
          category: Quantity
          kind: Timestamp
          unit: UnixMillisecond
          firstSummary: WORD_CLOUD
      - attributeName: domainLookupEnd
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
        tags:
          category: Quantity
          kind: Timestamp
          unit: UnixMillisecond
          firstSummary: WORD_CLOUD
      - attributeName: domainLookupElapsed
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
      - attributeName: connectStart
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
        tags:
          category: Quantity
          kind: Timestamp
          unit: UnixMillisecond
          firstSummary: WORD_CLOUD
      - attributeName: connectEnd
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
        tags:
          category: Quantity
          kind: Timestamp
          unit: UnixMillisecond
          firstSummary: WORD_CLOUD
      - attributeName: connectElapsed
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
      - attributeName: redirectStart
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
        tags:
          category: Quantity
          kind: Timestamp
          unit: UnixMillisecond
          firstSummary: WORD_CLOUD
      - attributeName: redirectEnd
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
        tags:
          category: Quantity
          kind: Timestamp
          unit: UnixMillisecond
          firstSummary: WORD_CLOUD
      - attributeName: redirectElapsed
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
      - attributeName: requestStart
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
        tags:
          category: Quantity
          kind: Timestamp
          unit: UnixMillisecond
          firstSummary: WORD_CLOUD
      - attributeName: responseStart
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
        tags:
          category: Quantity
          kind: Timestamp
          unit: UnixMillisecond
          firstSummary: WORD_CLOUD
      - attributeName: responseEnd
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
        tags:
          category: Quantity
          kind: Timestamp
          unit: UnixMillisecond
          firstSummary: WORD_CLOUD
      - attributeName: requestElapsed
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
      - attributeName: responseElapsed
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
      - attributeName: totalElapsed
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
      - attributeName: loadEventStart
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
        tags:
          category: Quantity
          kind: Timestamp
          unit: UnixMillisecond
          firstSummary: WORD_CLOUD
      - attributeName: loadEventEnd
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
        tags:
          category: Quantity
          kind: Timestamp
          unit: UnixMillisecond
          firstSummary: WORD_CLOUD
      - attributeName: loadEventElapsed
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
      - attributeName: domLoadingStart
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
        tags:
          category: Quantity
          kind: Timestamp
          unit: UnixMillisecond
          firstSummary: WORD_CLOUD
      - attributeName: domLoadingEnd
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
        tags:
          category: Quantity
          kind: Timestamp
          unit: UnixMillisecond
          firstSummary: WORD_CLOUD
      - attributeName: domLoadingElapsed
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
      - attributeName: domContentLoadedEventStart
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
        tags:
          category: Quantity
          kind: Timestamp
          unit: UnixMillisecond
          firstSummary: WORD_CLOUD
      - attributeName: domContentLoadedEventEnd
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
        tags:
          category: Quantity
          kind: Timestamp
          unit: UnixMillisecond
          firstSummary: WORD_CLOUD
      - attributeName: domContentLoadedEventElapsed
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
      - attributeName: unloadEventStart
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
        tags:
          category: Quantity
          kind: Timestamp
          unit: UnixMillisecond
          firstSummary: WORD_CLOUD
      - attributeName: unloadEventEnd
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
        tags:
          category: Quantity
          kind: Timestamp
          unit: UnixMillisecond
          firstSummary: WORD_CLOUD
      - attributeName: unloadEventElapsed
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
    enrich:
      enrichments:
        - enrichmentName: ip2GeoEnrichment
          foreignKey:
            - ipAddress
          missingLookupPolicy: StoreFillInValue
          contextName: _ip2geo
          contextAttributes:
            - attributeName: city
              as: city
              fillIn: MISSING
            - attributeName: country
              as: country
              fillIn: MISSING
            - attributeName: countryIsoCode
              fillIn: MISSING
            - attributeName: subdivisionCode
              fillIn: MISSING
        - enrichmentName: deviceEnrichment
          foreignKey:
            - sessionId
          missingLookupPolicy: StoreFillInValue
          contextName: devices
          contextAttributes:
            - attributeName: platform
              as: platform
              fillIn: MISSING
            - attributeName: os
              as: os
              fillIn: MISSING
            - attributeName: browser
              as: browser
              fillIn: MISSING
            - attributeName: deviceType
              as: deviceType
              fillIn: MISSING
            - attributeName: screenWidth
              as: screenWidth
              fillIn: 0
            - attributeName: screenHeight
              as: screenHeight
              fillIn: 0
            - attributeName: availWidth
              as: availWidth
              fillIn: 0
            - attributeName: availHeight
              as: availHeight
              fillIn: 0
        - enrichmentName: cookiesEnrichment
          foreignKey:
            - sessionId
          missingLookupPolicy: StoreFillInValue
          contextName: cookies
          contextAttributes:
            - attributeName: googleAnalyticsUserId
              as: googleAnalyticsUserId
              fillIn: MISSING
            - attributeName: cookieLawInfoConsent
              as: cookieLawInfoConsent
              fillIn: MISSING
            - attributeName: cookieLawInfoCheckboxNecessary
              as: cookieLawInfoCheckboxNecessary
              fillIn: MISSING
            - attributeName: cookieLawInfoCheckboxNonNecessary
              as: cookieLawInfoCheckboxNonNecessary
              fillIn: MISSING
            - attributeName: viewedCookiePolicy
              as: viewedCookiePolicy
              fillIn: MISSING
            - attributeName: ajsAnonymousId
              as: ajsAnonymousId
              fillIn: MISSING
            - attributeName: phpSessionId
              as: phpSessionId
              fillIn: MISSING
      ingestTimeLag: []
    postStorageStage:
      features:
        - featureName: byGeo
          dimensions:
            - country
            - city
            - countryIsoCode
            - subdivisionCode
          attributes:
            - requestElapsed
            - responseElapsed
            - totalElapsed
          featureInterval: 60000
        - featureName: byPlatformOsBrowserDevice
          dimensions:
            - platform
            - os
            - browser
            - deviceType
          attributes:
            - requestElapsed
            - responseElapsed
            - totalElapsed
          featureInterval: 60000
        - featureName: byPageInfo
          dimensions:
            - pageUri
            - country
            - city
            - requestMethod
            - referrer
          attributes:
            - requestElapsed
            - responseElapsed
            - totalElapsed
          featureInterval: 60000
        - featureName: byActionPageContext
          dimensions:
            - action
            - page
            - context
          attributes:
            - requestElapsed
            - responseElapsed
            - totalElapsed
          featureInterval: 60000
        - featureName: byUtmParams
          dimensions:
            - utmSource
            - utmMedium
            - utmCampaign
            - utmTerm
            - utmContent
          attributes:
            - requestElapsed
            - responseElapsed
            - totalElapsed
          featureInterval: 60000
        - featureName: bySessionId
          dimensions:
            - sessionId
          attributes: []
          featureInterval: 60000
        - featureName: uriBySessionId
          dimensions:
            - sessionId
          attributes:
            - pageUri
          dataSketches:
            - LastN
          featureAsContextName: pageViews_pageUriBySessionId
          items: 25
          ttl: 86400000 # 1 day
          featureInterval: 60000
  - signalName: pageTransitions
    missingAttributePolicy: Reject
    attributes:
      - attributeName: fromPage
        type: String
      - attributeName: toPage
        type: String
      - attributeName: count
        type: Integer
      - attributeName: timeTakenInMillis
        type: Integer
    postStorageStage:
      features:
        - featureName: byFromTo
          dimensions:
            - fromPage
            - toPage
          attributes:
            - count
            - timeTakenInMillis
          featureInterval: 60000
  - signalName: auditPageViews_pageUriBySessionId
    missingAttributePolicy: Reject
    attributes:
      - attributeName: _operation
        type: String
      - attributeName: sessionId
        type: String
      - attributeName: prevSessionId
        type: String
      - attributeName: pageUriCollection
        type: String
      - attributeName: prevPageUriCollection
        type: String
    postStorageStage:
      features:
        - featureName: byOperation
          dimensions:
            - _operation
          attributes: []
          featureInterval: 60000
        - featureName: bySessionId
          dimensions:
            - sessionId
          attributes: []
          featureInterval: 60000
contexts:
  - contextName: pageViews_pageUriBySessionId
    missingAttributePolicy: Reject
    attributes:
      - attributeName: sessionId
        type: String
      - attributeName: pageUriCollection
        type: String
    primaryKey:
      - sessionId
    missingLookupPolicy: FailParentLookup
    auditEnabled: true
  - contextName: cookies
    missingAttributePolicy: Reject
    attributes:
      - attributeName: sessionId
        type: String
      - attributeName: googleAnalyticsUserId
        type: String
        description: User identifier retrieved from _ga field generated by Google Analytics
      - attributeName: ajsAnonymousId
        type: String
        description: From ajs_anonymous_id
      - attributeName: cookieLawInfoCheckboxNecessary
        type: String
      - attributeName: cookieLawInfoCheckboxNonNecessary
        type: String
      - attributeName: cookieLawInfoConsent
        type: String
      - attributeName: viewedCookiePolicy
        type: String
      - attributeName: language
        type: String
        description: Website language
      - attributeName: phpSessionId
        type: String
        description: From PHPSESSID
      - attributeName: wpeAuth
        type: String
      - attributeName: other
        type: String
    primaryKey:
      - sessionId
    missingLookupPolicy: FailParentLookup
  - contextName: devices
    missingAttributePolicy: Reject
    attributes:
      - attributeName: sessionId
        type: String
      - attributeName: platform
        type: String
        missingAttributePolicy: StoreDefaultValue
        default: MISSING
      - attributeName: os
        type: String
        missingAttributePolicy: StoreDefaultValue
        default: MISSING
      - attributeName: browser
        type: String
        missingAttributePolicy: StoreDefaultValue
        default: MISSING
      - attributeName: deviceType
        type: String
        missingAttributePolicy: StoreDefaultValue
        default: MISSING
      - attributeName: screenWidth
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
      - attributeName: screenHeight
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
      - attributeName: availWidth
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
      - attributeName: availHeight
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
    primaryKey:
      - sessionId
    missingLookupPolicy: FailParentLookup
    enrichments: []
  - contextName: sessions
    missingAttributePolicy: Reject
    attributes:
      - attributeName: sessionId
        type: String
      - attributeName: siteUrl
        type: String
        missingAttributePolicy: StoreDefaultValue
        default: MISSING
      - attributeName: ipAddress
        type: String
        missingAttributePolicy: StoreDefaultValue
        default: MISSING
      - attributeName: tenantName
        type: String
        missingAttributePolicy: StoreDefaultValue
        default: MISSING
      - attributeName: platform
        type: String
        missingAttributePolicy: StoreDefaultValue
        default: MISSING
      - attributeName: screenWidth
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
      - attributeName: screenHeight
        type: Integer
        missingAttributePolicy: StoreDefaultValue
        default: 0
    primaryKey:
      - sessionId
    missingLookupPolicy: FailParentLookup
    enrichments: []
